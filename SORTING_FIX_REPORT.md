# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

## –ü—Ä–æ–±–ª–µ–º–∞
–ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–ª –Ω–µ—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ —Å–∏–≥–Ω–∞–ª–æ–≤, —Ö–æ—Ç—è —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–ª –¥–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ `score_week` (–ø–æ —É–±—ã–≤–∞–Ω–∏—é).

## –ê–Ω–∞–ª–∏–∑

### 1. –°–µ—Ä–≤–µ—Ä (signal_websocket_server.py)
‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ**

SQL-–∑–∞–ø—Ä–æ—Å –≤ —Å—Ç—Ä–æ–∫–µ 92 —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É:
```sql
ORDER BY sc.score_week DESC NULLS LAST, sc.timestamp DESC
```

–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:
- –í—Å–µ 77 —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏
- –ü–µ—Ä–≤—ã–º–∏ –∏–¥—É—Ç —Å–∏–≥–Ω–∞–ª—ã —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º `score_week`
- –ü—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º `score_week` —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `timestamp DESC`

### 2. –ö–ª–∏–µ–Ω—Ç (signal_websocket_client.py)
‚ùå **–ù–∞–π–¥–µ–Ω–æ 2 –æ—à–∏–±–∫–∏**

#### –û—à–∏–±–∫–∞ #1: –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –≤ –±—É—Ñ–µ—Ä–µ (—Å—Ç—Ä–æ–∫–∞ 211)
**–ë—ã–ª–æ:**
```python
self.signal_buffer = (self.signal_buffer + signals)[-self.buffer_size:]
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–æ–≤—ã–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –¥–æ–±–∞–≤–ª—è–ª–∏—Å—å –≤ –ö–û–ù–ï–¶ —Å—Ç–∞—Ä–æ–≥–æ –±—É—Ñ–µ—Ä–∞
- –û–±—â–∏–π –ø–æ—Ä—è–¥–æ–∫ –Ω–∞—Ä—É—à–∞–ª—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö

**–ü—Ä–∏–º–µ—Ä:**
```
–°—Ç–∞—Ä—ã–π –±—É—Ñ–µ—Ä: [signal(score=60), signal(score=55)]
–ù–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã: [signal(score=75), signal(score=70)]
–†–µ–∑—É–ª—å—Ç–∞—Ç: [60, 55, 75, 70] ‚ùå –ù–ï –û–¢–°–û–†–¢–ò–†–û–í–ê–ù–û
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```python
# –ó–∞–º–µ–Ω—è–µ–º –±—É—Ñ–µ—Ä –Ω–æ–≤—ã–º–∏ —Å–∏–≥–Ω–∞–ª–∞–º–∏ (—Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Å —Å–µ—Ä–≤–µ—Ä–∞)
# –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –Ω–µ –Ω–∞—Ä—É—à–∞–µ–º –∏—Ö –ø–æ—Ä—è–¥–æ–∫
self.signal_buffer = signals[-self.buffer_size:]
```

#### –û—à–∏–±–∫–∞ #2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ SignalProcessor (—Å—Ç—Ä–æ–∫–∞ 431)
**–ë—ã–ª–æ:**
```python
filtered.sort(key=lambda x: x.get('score', 0), reverse=True)
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ª—é `'score'` –≤–º–µ—Å—Ç–æ `'score_week'`
- –ü–æ–ª–µ `'score'` –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å–∏–≥–Ω–∞–ª–∞—Ö
- –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```python
# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ score_week (–∫–∞–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
# –°–∏–≥–Ω–∞–ª—ã —É–∂–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞, –Ω–æ –ø–µ—Ä–µ—Å–æ—Ä—Ç–∏—Ä—É–µ–º –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
filtered.sort(key=lambda x: x.get('score_week', 0), reverse=True)
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –¢–µ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞ (test_signal_order.py)
```
‚úÖ –°–ò–ì–ù–ê–õ–´ –û–¢–°–û–†–¢–ò–†–û–í–ê–ù–´ –ü–†–ê–í–ò–õ–¨–ù–û (–ø–æ —É–±—ã–≤–∞–Ω–∏—é score_week)
‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: –ø–æ—Ä—è–¥–æ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ DESC

–¢–æ–ø-5 —Å–∏–≥–Ω–∞–ª–æ–≤:
1. REDUSDT      score_week=75.00
2. ALPHAUSDT    score_week=75.00
3. XTZUSDT      score_week=69.90
4. NEOUSDT      score_week=69.90
5. CTSIUSDT     score_week=69.90
```

### –¢–µ—Å—Ç –∫–ª–∏–µ–Ω—Ç–∞ (test_client_order.py)
```
‚úÖ –°–∏–≥–Ω–∞–ª—ã –≤ callback –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
‚úÖ –ë—É—Ñ–µ—Ä –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

–¢–æ–ø-5 score_week –≤ –±—É—Ñ–µ—Ä–µ: [75.0, 75.0, 69.9, 69.9, 69.9]
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
1. `signal_websocket_client.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ–±–µ –æ—à–∏–±–∫–∏
2. `test_signal_order.py` - –Ω–æ–≤—ã–π —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
3. `test_client_order.py` - –Ω–æ–≤—ã–π —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö: —Å–µ—Ä–≤–µ—Ä ‚Üí –∫–ª–∏–µ–Ω—Ç ‚Üí –±—É—Ñ–µ—Ä ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω–æ–µ –ø–æ–ª–µ `score_week` –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤–µ–∑–¥–µ
3. üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ª–æ–≥–∏–∫–µ –ø–µ—Ä–µ–¥–∞—á–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
./venv/bin/python test_signal_order.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ –∫–ª–∏–µ–Ω—Ç–µ
./venv/bin/python test_client_order.py
```

## –î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2025-10-08
